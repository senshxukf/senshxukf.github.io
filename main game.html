<html>
    <head>
        <!-- Includes the p5.collide2D addon library -->
        <script defer src="https://unpkg.com/p5.collide2d"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js" integrity="sha512-uaz5GpnQoE6t5echKlX8P52czvsIGgLPcvlzfvRubLZ1Hp8JemUDnbUiAahbVtPb+jUVrNETuXvAhDDF/N3M4w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src = " https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/addons/p5.sound.js"></script>
    </head>
    <body>
        <p id = "test_for_collision"> Test For Collision</p> 
        <script>
            let w = window.innerWidth
            let h = window.innerHeight
            let player //delcare an unknown variable
            let detect = false
            let hit = false
            let baseHealth = 100
            let base_damage = false
            let speed = 5
            let enemy_circles = [[]]


            function preload(){ //Allows visual graphics to be seen on character
                wizardRight =  loadImage('2pixil-frame-0  wizard-Right(2).png')
                wizardLeft = loadImage('3pixil-frame-0 wizard-Left(3).png')
                wizardForward = loadImage('4pixil-frame-0 wizard-Forward (4).png')
                wizardBack = loadImage('5pixil-frame-0 wizard-Back(5).png')
                cauldronBase = loadImage('6pixil-frame-0 base-caludron (2).png')
                cauldronDamage = loadSound('Metal Strike-[AudioTrimmer.com].mp3')
            }

            function setup(){
                createCanvas(w,h)
                player = new jumper() //defining jumper as new object
                window.ctx = canvas.getContext("2d")

            }
             function createOpps(){
                    //create the constant size of the circles
                    let circle_radius = 50

                    //find border sides
                    let borderSide = Math.floor(random(0,4))
                    let cx
                    let cy
                    console.log(borderSide)
                    if (borderSide == 0){
                         cy = 0
                         cx = Math.random() * (w - 2 * circle_radius) + circle_radius // Random x-coordinate
                    }

                    if (borderSide == 1){
                         cx = w
                         cy = Math.random() * (h - 2 * circle_radius) + circle_radius // Random y-coordinate
                    }

                    if (borderSide == 2){
                         cy = h
                         cx = Math.random() * (w - 2 * circle_radius) + circle_radius // Random y-coordinate
                    }

                    if (borderSide == 3){
                         cx = 0
                         cy = Math.random() * (h - 2 * circle_radius) + circle_radius // Random y-coordinate
                        
                    }

                    //create a random speed for the circles to reach the center
                    let speed = Math.random() * 2 + 1; // Random speed between 1 and 3

                    //add circles being created to container using the .push method (enemy_circles)
                    //this will be used to constanly spawn in new circles after some of them are defeated
                    enemy_circles.push([cx,cy,speed])
                    }
                
            //create new object
            function jumper() {
                this.x = w/2
                this.y = 0
                //create opposing force
                this.lift = -12
                //create velocity
                this.velocity = 0

                //function to set up initial jumper
                this.show = function() {
                    //Here is where we determine what it will look like
                    fill("rgba(255,0,255,0.25)")
                    circle(w/2,h/2,50)
                    ellipseMode(CENTER)
                    fill("rgba(0,0,0,0.5)")
                    rect(w/2,h,100,100)
                    let rx = 300
                    let ry = 150
                    let rw = 950
                    let rh = 450
                    hit = collideRectCircle(rx, ry, rw, rh, w/2,h/2,50)
                    if (keyIsDown(87,83,65,68)){
                        cx = this.x
                        cy = this.y
                    }
                }
                this.hitbox = function(){// Used as a hitbox for the player
                    fill(0,0,255)
                    circle(this.x,this.y,75)
                    ellipseMode(CENTER)
                    collideRectCircle(0,0,w,10,this.x,this.y,75)
                    collideRectCircle(0,0,10,h,this.x,this.y,75)
                    collideRectCircle(0,605,w,10,this.x,this.y,75)
                    collideRectCircle(0,1500,w,10,this.x,this.y,75)
                }

                this.base = function(){ //Picture for he cauldron in the middle of the screen
                    image(cauldronBase,w/2,h/2, 100, 100)
                    imageMode(CENTER)
                }
                this.forward = function(){  //allows the player character to be visible while moving foraward
                    image(wizardForward,this.x,this.y,130,135)
                    imageMode(CENTER)
                    }
                    
                this.up = function() {//allows the player to be visible while moving up
                    //add a keypressed
                    if (keyIsDown(87)){
                        let cx = this.x
                        let cy = this.y
                        this.y += this.lift
                        image(wizardBack,cx,cy,130,135)
                        
                    }
                    else{
                        fill("rgba(0,0,0,0)")
                    }
                }
                this.down = function() { //allows for the player to be visible for moving down
                    //add a keypressed
                    if (keyIsDown(83)){
                        let cx = this.x
                        let cy = this.y
                        this.y -= this.lift
                    }
                }
                this.left = function(){ //allows for the player to be seen while moving to the left 
                    if (keyIsDown(65)){
                        let cx = this.x
                        let cy = this.y
                        this.x -= 7
                        image(wizardLeft,cx, cy,150,150)
                        imageMode(CENTER)
                    }
                    else{
                        fill("rgba(0,0,0,0)")
                    }
                }
                this.right = function(){ // allows for the player to be able to be seen moving to the right
                    if (keyIsDown(68)){
                        let cx = this.x
                        let cy = this.y
                        this.x += 7
                        image(wizardRight, cx, cy,150,150)
                        imageMode(CENTER)
                        fill("rgba(0,0,0,0)")
                    }
                }
                    
                //function to loop on repeat within the draw function
                this.update = function() {
                    //what direction am i traveling
                    this.y += this.velocity
                    this.x += this.velocity
                    if (detect === true){
                        cauldronDamage.play()
                    }
                    if (hit === true ){
                        this.velocity *=2
                        this.lift = -7.5
                    }
                    else{ //returns speed of character to normal
                        this.lift = -12
                        this.velocity = 0
                    }
                    //calculate the center of the video game screen (used to find the cauldron base)
                    //I used the forEach method because its the easiest way for me to understand
                    enemy_circles.forEach(circle =>{
                        //calculate the size of the canvas divided by 2 (equals the center)
                        let dx = canvas.width / 2 - circle.x
                        let dy = canvas.height / 2 - circle.y

                        //this equation allows the circle's path to be charted towards the center using (Math.sqrt,) which is short for square root.
                        let distanceToCenter = Math.sqrt(dx * dx + dy * dy)

                        //this part allows for the enemy circles to move towards the center at a random speed given
                        circle.x += dx / distanceToCenter * circle.speed
                        circle.y += dy / distanceToCenter * circle.speed
                        })

                }
            }

            function draw() {// allows for functions and images too be 
                clear()
                player.hitbox()
                player.show()
                player.base()
                player.update()
                player.forward()
                player.up()
                player.down()
                player.left()
                player.right()
                createOpps()
                for(let i = 0; i < enemy_circles.length; i++){
                    fill("red")
                    circle(enemy_circles[i][0],enemy_circles[i][1],50)
                }
                enemy_circles.forEach(circle => {
                    //the ctx is short for context, in which ctx is the indicatior if I am working with the lifecycle methods
                    //lifecycle methods have three phases that include mounting, updating, and unmounting
                    //I found this method after watching tutorial videos on how to create js games that have characters that move to a specific point
                    ctx.beginPath()

                    ctx.arc(circle.x, circle.y, circle.radius, 0, Math.PI * 2)

                    ctx.fill()

                    ctx.closePath()
                    //the closePath() method from what i researched attempts to add a straight line from the current x and y position to the other point you want the 
                    //circle to end up
                    //another thing I learned that the closePath() method does is that it creates a line that isn't visible on the canvas, but its there

                    })
            

            //create the amount of time it takes to spawn the circles
            //start the enemy circle loop
                }


        </script>
         <h1 id = "base_health"></h1>
        <style>
            body{
                background-image:url("https://t3.ftcdn.net/jpg/06/04/22/36/360_F_604223671_RS327qPmIEjzubYMQz7oMVpGw7ROCo2S.jpg");
                background-repeat: no-repeat;
                background-size: cover;
            }
            h1{
                color: white;
                font-size: 50;
                height: 10px;
                width: 10px;
            }
        </style>

    </body>
</html>
            


